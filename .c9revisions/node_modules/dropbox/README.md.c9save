{"ts":1341058602383,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"# dropbox-node\n\nAn OAuth-enabled Node.js client for working with the Dropbox API.\n\n## Installation\n\ndropbox-node depends on [node-oauth](http://github.com/ciaranj/node-oauth).\n\nTo install via npm\n\n    npm install dropbox\n\nTo install by hand, download the module and create a symlink in `~/.node_libraries`\n\n    $ ln -s /path/to/dropbox-node/ ~/.node_libraries/dropbox-node\n\n## Usage\n\nTo start, grab a consumer key and secret from [dropbox.com/developers](https://dropbox.com/developers).\n\n### Object construction and access key pair retrieval\nFirst construct a DropboxClient object, passing in the consumer key and secret.\n\n    var dropbox = new DropboxClient(consumer_key, consumer_secret)\n\nBefore calling any Dropbox API methods, an access token pair must be obtained. This can be done one of two ways:\n\n  1. If the access token and secret are known a priori, they can be passed directly into the DropboxClient constructor.\n\n        var dropbox = new DropboxClient(consumer_key, consumer_secret,\n                                        access_token, access_token_secret)\n\n  2. Otherwise, `getAccessToken` must be called in order to initialize the OAuth credentials.\n\n        dropbox.getAccessToken(dropbox_email, dropbox_password, callback)\n\nThe callback given to `getAccessToken` takes an error object, an access token, and an access token secret (see example below). **Please note that users' passwords should never be stored.** It is best to acquire a token once and then use it for all subsequent requests.\n\n### Calling API methods\n\ndropbox-node provides methods covering [each of the Dropbox API methods](https://www.dropbox.com/developers/docs). For example, to fetch and print the display name and email address associated with your account:\n\n    dropbox.getAccountInfo(function (err, data) {\n      if (err) console.log('Error: ' + err)\n      else console.log(data.display_name + ', ' + data.email)\n    })\n\nNote that (at least at the start of a user's session) a valid access token pair must be obtained prior to interacting with the rest of the Dropbox API. This means that the API methods must be invoked within the callback passed to `getAccessToken` unless it is guaranteed that `getAccessToken` was called previously. As an example of this latter case, if building a web app, one could call API methods directly in a route that can only be accessed after going through a sign-in phase in which a call to `getAccessToken` is made.\n\nHere we upload a file and remotely move it around before deleting it.\n\n    dropbox.getAccessToken(email, pwd, function (err, token, secret) {\n      // Upload foo.txt to the Dropbox root directory.\n      dropbox.putFile('foo.txt', 'foo.txt', function (err, data) {\n        if (err) return console.error(err)\n\n        // Move it into the Public directory.\n        dropbox.move('foo.txt', 'Public/foo.txt', function (err, data) {\n          if (err) return console.error(err)\n\n          // Delete the file.\n          dropbox.deleteItem('Public/foo.txt', function (err, data) {\n            if (err) console.error(err.stack)\n          })\n        })\n      })\n    })\n\nFor a more practical example, check out this [walkthrough of building a simple Dropbox file browser](http://evanmeagher.net/2010/10/dropbox-file-browser).\n\n### Stream-based file-downloading\n\nAs of v0.3.1, dropbox-node exposes a method `getFileStream` that allows stream-based file-downloading. This is useful when downloading large files that wouldn't easily fit in memory and thus don't play nicely with `getFile`.\n\n`getFileStream` returns an EventEmitter representing the request. The target file will be downloaded in chunks and dealt with according to the callbacks you register. Here we fetch a large file and write it to disk:\n\n    var request = dropbox.getFileStream(\"path/to/huge/file\")\n      , write_stream = require('fs').createWriteStream(\"out\")\n\n    request.on('response', function (response) {\n      response.on('data', function (chunk) { write_stream.write(chunk) })\n      response.on('end', function () { write_stream.end() })\n    })\n    request.end()\n\n### Optional arguments\n\nOptional arguments (as specified in the [Dropbox API documentation](https://www.dropbox.com/developers/docs)) can be given to API methods via an argument object.\n\nFor example, here we call `getAccountInfo` and direct the API to include the HTTP status code in the response.\n\n    dropbox.getAccountInfo({ status_in_response: true }, callback)\n\nEach method (except `getAccessToken`) can optionally take an access token and an access token secret as strings. This is the one way to get around having to call `getAccessToken` in cases where a valid key pair is known.\n\nFor example, here we fetch the metadata about the Dropbox root directory, passing in an explicit key pair stored in variables.\n\n    dropbox.getMetadata('', { token: token, secret: secret }, callback)\n\n## API\n\n### new DropboxClient()\n\n### DropboxClient#getAccessToken(email, password, callback(err, access_token, access_token_secret))\n\nFetches an access token and secret based on the email and password given. Stores the token and secret in the DropboxClient instance and calls the callback them.\n\n### DropboxClient#getAccountInfo([optargs], callback(err, accountInfo))\nhttps://www.dropbox.com/developers/reference/api#account-info\n\nGets account information from the client.\n\n### DropboxClient#createAccount(email, first_name, last_name, password, [optargs], callback(err, accountInfo))\n\nCreates a new Dropbox account.\n\n### DropboxClient#getFile(path, [optargs], [callback(err, body)])\nhttps://www.dropbox.com/developers/reference/api#files-GET\n\nRetrieves a file specified by the path. `callback` will be called with a possible error and the buffer of the contents of the file. This method also returns a readable stream that can be used to pipe the contents.\n\n```js\ndropboxClient('mybigfile.mpeg').pipe(fs.createWriteStream('localbigfile.mpeg');\n```\n\n`optargs` can also have a `rev` field to specify the revision of the file to download, and `range` for [HTTP Range Retrieval Requests](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35.2).\n\n```js\n// download the first 1024 byte\ndropboxClient('file.zip', { range: 'bytes=0-1024'}, function(err, data) {\n  console.log(data.length); // 1024. that is if the file is at least 1024 bytes\n});\n```\n\n### DropboxClient#putFile(filepath, remotepath, [optargs], callback(err, metadata))\nhttps://www.dropbox.com/developers/reference/api#files_put\n\nUploads a file specified by `filepath` to `remotepath` on Dropbox. Dropbox currently does not support streaming uploads, and the max upload is 150 MB. `optargs` can also take additional fields `overwrite` and `parent_rev`.\n\n### DropboxClient#put(contents, remotepath, [optargs], callback(err, metadata))\no\nSimilar to `putFile()` but places `contents` into a created file at `remotepath`. `contents` can be a buffer or string.\n\n### DropboxClient#getMetadata(path, [optargs], callback(err, metadata))\nhttps://www.dropbox.com/developers/reference/api#metadata\n\nGets metadata of file/folder specified by `path`. `optargs` can have fields `hash`, `list`, `include_deleted` and `rev`.\n\n### DropboxClient#delta([cursor], [optargs], callback(err, changes))\nhttps://www.dropbox.com/developers/reference/api#delta\n\nKeeps up with changes from a client's Dropbox. `changes` is an array of arrays with first element as the path and second as metadata.\n\n### DropboxClient#changesStream([startingCursor], [optargs])\nConvenient method that provides a more friendly API to `delta()`. Returns an event emitter that emits `data` events with `path` and `metadata` parameters on changes to the client's Dropbox. Also can emit `reset` and `error` events. The returned event emitter also has a `pause()` and `resume()` methods.\n\n### DropboxClient#search(folderpath, query, [optargs], callback(err, results))\nhttps://www.dropbox.com/developers/reference/api#search\n\nSearches `folderpath` for files matching `query`. `results` is an array of metadata. `optargs` can take `file_limit` and `include_deleted`.\n\n### DropboxClient#getThumbnail(filepath, [optargs], [callback(err, body, metadata)])\nhttps://www.dropbox.com/developers/reference/api#thumbnails\n\nDownloads a thumbnail image located at `filepath`. Like `getFile()`, the `callback` can get buffered data or the returned readable stream can be piped. `optargs` can take `format` and `size` fields.\n\n### DropboxClient#copy(from_path, to_path, [optargs], callback)\nhttps://www.dropbox.com/developers/reference/api#fileops-copy\n\nCopies a file. `from_copy_ref` field can be given in `optargs` to use it instead of `from_path`.\n\n### DropboxClient#createFolder(path, [optargs], callback(err, metadata))\nhttps://www.dropbox.com/developers/reference/api#fileops-create-folder\n\nCreates a folder at the given path.\n\n### DropboxClient#deleteItem(path, [optargs], callback(err, metadata))\nhttps://www.dropbox.com/developers/reference/api#fileops-delete\n\nDeletes file or folder from path.\n\n### DropboxClient#move(from_path, to_path, [optargs], callback(err, metadata))\nhttps://www.dropbox.com/developers/reference/api#fileops-move\n\nMoves a file to another path.\n\n\n## Testing\n\ndropbox-node depends on [jasmine-node](http://github.com/mhevery/jasmine-node) for testing. Note that the currently-implemented tests are trivial, due to a lack of a way to effectively mock the Dropbox API.\n\nRun specs with `node specs.js` from the root `dropbox-node` directory.\n\n## TODO\n* Improve test coverage.\n* Improve documentation.\n* Add ability to interact with application sandboxes.\n"]],"start1":0,"start2":0,"length1":0,"length2":9547}]],"length":9547}
